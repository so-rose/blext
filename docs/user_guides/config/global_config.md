!!! abstract
	Learn how to configure `blext` itself.

	**Not to be confused** with extension configuration:

	- **Global Configuration** _changes how `blext` itself works_, in a global `config.toml`.
	- **Extension Configuration** _changes how a `blext` project_ works, in a project `pyproject.toml`.

# Global Config
!!! warning
	There is currently no way to alter the global configuration file location.

	If this is something you need, please submit an Issue to start the conversation.

`blext` can be configured using the global config file `config.toml`, by environment variables, or for each command using CLI argument.

**In general**, `config.toml` can be found here:

- **Linux**: `$HOME/.config/blext/config.toml`
- **MacOS**: `$HOME/Library/Application Support/blext/config.toml`
- **Windows**: `$HOME\\AppData\\Local\\blext\\blext\\config.toml`

!!! tip
	To guarantee the location of `config.toml`, run:
	```
	$ blext show path global_config
	```

!!! note
	The config path is derived from the [`platformdirs`](https://platformdirs.readthedocs.io/en/latest/index.html) library, like in this Python snippet:
	```python
	import platformdirs
	platformdirs.user_config_dir('blext', 'blext')
	```

	For "exotic" platforms, please refer to the `platformdirs` documentation to locate the global configuration file.

## Overview
All global configuration fields may be specified in `config.toml`, by environment variable, or by CLI argument.

|       `config.toml` Field      	|          Environment Var         	|           CLI Argument           	|
|:------------------------------:	|:--------------------------------:	|:--------------------------------:	|
|     `cfg.path_global_cache`    	|     `BLEXT_PATH_GLOBAL_CACHE`    	|     `--cfg.path_global_cache`    	|
|     `cfg.local_bl_platform`    	|     `BLEXT_LOCAL_BL_PLATFORM`    	|     `--cfg.local_bl_platform`    	|
| `cfg.path_default_blender_exe` 	| `BLEXT_PATH_DEFAULT_BLENDER_EXE` 	| `--cfg.path_default_blender_exe` 	|
|        `cfg.path_uv_exe`       	|        `BLEXT_PATH_UV_EXE`       	|        `--cfg.path_uv_exe`       	|

!!! tip
	You can always show your current global configuration `toml` using:
	```
	$ blext show global_config
	```

	`POSIX` shell users can use this to easily generate a new global config file:
	```bash
	blext show global_config > $(blext show path global_config)
	```

!!! example
	One default `config.toml` generated by `blext show global_config` might look like:
	```toml
	[cfg]
	path_global_cache = "/home/user/.cache/blext"
	local_bl_platform = "linux-x64"
	path_default_blender_exe = "/home/user/.local/bin/blender"
	path_uv_exe = "/home/user/.local/share/uv/tools/blext/bin/uv"
	```


## Description
### `cfg.path_global_cache`
Path to the global cache path, whose contentes are managed entirely by `blext`.

**Python Type**: `Path`.

**Default**: `platformdirs.user_config_dir('blext', 'blext')`.

!!! note
	This folder **must** be readable and writeable by the `blext` command.

!!! example
	```toml
	[cfg]
	path_global_cache = "/path/to/global/blext/cache"  ## On Windows, use valid backslash paths.
	```

!!! example "Build Script Extension w/Temporary Global Cache Path"
	When building a script extension, wheels are downloaded to a subfolder in the global cache path.

	To control where those files go, one can alter the global cache path temporarily:
	```
	$ blext build script-extension.py --cfg.path_global_cache /home/user/special-blext-cache
	```

	_This is useful for CI/CD caching in particular._



### `cfg.local_bl_platform`
The Blender platform supported by the environment running the `blext` command.

This field should be thought of as a kind of "escape hatch", if auto-detection of the local `BLPlatform` fails. 
_It's generally it's best to **leave this field alone**, as setting it incorrectly can very easily break `blext run` and similar._

**Python Type**: `BLPlatform` (`linux-x64`, `linux-arm64`, `macos-x64`, `macos-arm64`, `windows-x64`, `windows-arm64`).

**Default**: Hard-coded mapping from `platform.system()` and `platform.machine()` to specific Blender platforms.

!!! warning
	**If** you get an "Unknown Platform" error, you can always manually set `cfg.local_bl_platform` as a workaround.

	However, we would appreciate if you [file a bug-report Issue](https://codeberg.org/so-rose/blext/issues/new).

!!! note
	The following combinations of `platform.system().lower()` and `platform.machine.lower()` are currently detectable:

	- `linux|linux2, x86_64|amd64`: Maps to `linux-x64`.
	- `linux|linux2, aarch64|arm*`: Maps to `linux-arm64`.
	- `darwin, x86_64|amd64`: Maps to `macos-x64`.
	- `darwin, aarch64|arm*`: Maps to `macos-arm64`.
	- `win32|cygwin|msys, x86_64|amd64`: Maps to `windows-x64`.
	- `win32|cygwin|msys, aarch64|arm*`: Maps to `windows-arm64`.

!!! example
	```toml
	[cfg]
	path_global_cache = "linux-x64"
	```



### `cfg.path_default_blender_exe`
The default Blender executable to use whenever `blext` needs to call Blender.

**Python Type**: `Path`

**Default**: Try detecting Blender's path in a manner specific to `BLPlatform`.

!!! note
	Blender will be searched for in manner dependent on the local `BLPlatform`:

	- `linux-x64|linux-arm64`: `shutil.which('blender')` will be tried.
	- `macos-x64|macos-arm64`: `shutil.which('blender')` and `/Applications/Blender.app/Contents/MacOS/Blender` will be tried.
	- `windows-x64|windows-arm64`: `shutil.which('blender')` and `shutil.which('blender.exe')` will be tried.

!!! note
	This `blender` executable will be used by the alias command `blext blender`.

!!! example
	```toml
	[cfg]
	path_default_blender_exe = "/dir/with/blender"  ## On Windows, use valid backslash paths.
	```


### `cfg.path_uv_exe`
The `uv` executable to use when `blext` calls `uv`.

**Python Type**: `Path`

**Default**: Use the `uv` executable, which is included in a dependency of `blext`.

!!! note
	This `uv` executable will be used by the alias command `blext uv`.

!!! warning
	**All** supported installation methods guarantee that the `uv` dependency has its files unpacked to the filesystem.
	Without this guarantee, `blext` cannot find the `uv` binary.

	Certain **unsupported** installation methods (ex. imports from a zip bundle, frozen installers) may not unpack all dependency files like this.
	In such cases, `blext` may work, but `uv` would not be auto-detected.

	In such an edge-cases, install `uv` manually and point `cfg.path_uv_exe` at it.

	**Please note** that while other `uv` versions may work, only the _exact_ version bundled with `blext` is officially supported.
	See [Reference / Policies / Versioning](../../reference/policies/versioning.md) for more.

!!! example
	```toml
	[cfg]
	path_uv_exe = "/path/to/uv"  ## On Windows, use valid backslash paths.
	```

## Tips and Tricks
!!! example "Generate Global Config from Env Vars"
	For a user `user` on Linux, using the `uv tool` installation method, a `config.toml` generated with the help of an environment variable might look like:
	```
	$ BLEXT_PATH_GLOBAL_CACHE=/home/user/special-blext-cache blext show global_config
	[cfg]
	path_global_cache = "/home/user/special-blext-cache"
	local_bl_platform = "linux-x64"
	path_default_blender_exe = "/home/user/.local/bin/blender"
	path_uv_exe = "/home/user/.local/share/uv/tools/blext/bin/uv"
	```
